<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-styles/typography.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">


<dom-module id="my-rooster">
  <template>
    <style>
      :host {
        display: block;
      }
      span {
        @apply(--paper-font-body1);
      }
      .lescontainer{
        margin: 23px;
        background-color: grey;
        width: 250px;
      }
      .date {
        margin-top: 10px;
        margin-bottom: 10px;
        font-size: 20px;
        background-color: blue;
      }
      .dagcontainer {
        background-color: green;
        margin: 5px;
        width: 296px;
      }
    </style>

    <h1 class="page-title">Rooster van {{username}} </h1>

      <div class="dagcontainer">
        <div class="date">
            <paper-button onclick="offset1Down"> < </paper-button>
          {{responseObject.datum}}
            <paper-button onclick="offset1Up"> > </paper-button>
          <br/>
        </div>
                <template is="dom-repeat" items="{{responseObject.lessen}}">
                  <div class="lescontainer">
                      <div class="tijd">
                        Tijd: {{item.tijd}}
                      </div>
                      <div class="vak">
                        Vak: {{item.vak}}
                      </div>
                      <div class="docent">
                        Docent: {{item.docent}}
                      </div>
                      <div class="lokaal">
                        Lokaal: {{item.lokaal}}
                      </div>
                  </div>
                </template>
      </div>

  	<iron-ajax
      id="ajaxRooster"
      method="POST"
  		url="/student/mijnrooster"
      handle-as="json"
  		on-response="responseHandlerRooster">
    </iron-ajax>


  </template>
  <script>
      Polymer({
        is: 'my-rooster',
        properties: {
          username: String,
          offset: 0,
          date: String,
          rol: {
            observer: 'fetchRooster',
          }
        },
        offset1Up: function() {
          this.offset = 1,
          this.date = this.responseObject,
          this.$.ajaxRooster.contentType="application/json";
          this.$.ajaxRooster.body = {"username":this.username ,"date":this.date, "offset":this.offset};
          this.$.ajaxRooster.generateRequest();
        },
        offset1down: function() {
          this.offset = -1;
          this.date = responseObject;
          this.$.ajaxRooster.contentType="application/json";
          this.$.ajaxRooster.body = {"username":this.username ,"date":this.date, "offset":this.offset};
          this.$.ajaxRooster.generateRequest();
        },
        responseHandlerRooster: function(request) {
          console.log(request.detail.response);
          this.responseObject = request.detail.response;
        },
        fetchRooster: function(){
          if (this.rol == "student") {
            this.$.ajaxRooster.contentType="application/json";
            this.$.ajaxRooster.body = {"username":this.username ,"date":this.date, "offset":this.offset};
            this.$.ajaxRooster.generateRequest();
          }
        }
      });
  </script>
</dom-module>
